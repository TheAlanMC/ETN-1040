<p-toast></p-toast>
<div class="card">
  <span class="text-900 text-xl font-bold mb-4 block">Mi Perfil</span>
  <div class="grid">
    <div class="col-12 lg:col-2">
      <div class="flex justify-center items-center mb-4 justify-content-center">
        <img [src]="profilePictureUrl" alt="Profile" style="width: 120px; height: 120px; border-radius: 50%; object-fit: cover" />
      </div>
      <div class="text-900 font-medium text-xl mb-3">Roles</div>
      <div *ngFor="let group of groups">
        <p class="m-0 p-0 text-600 line-height-3 mr-3">-{{ group }}</p>
      </div>
      <div class="text-900 font-medium text-xl mt-4 mb-3">Permisos</div>
      <div *ngFor="let rol of roles">
        <p class="m-0 p-0 text-600 line-height-3 mr-3">-{{ rol }}</p>
      </div>
    </div>
    <div class="col-12 lg:col-10" *ngIf="profile; else loading">
      <div class="grid formgrid p-fluid">
        <div class="field mb-4 col-12 md:col-6">
          <label for="firstName" class="font-medium text-900">Nombres</label>
          <input id="firstName" type="text" pInputText [formControl]="firstNameControl">
        </div>
        <div class="field mb-4 col-12 md:col-6">
          <label for="lastName" class="font-medium text-900">Apellidos</label>
          <input id="lastName" type="text" pInputText [formControl]="lastNameControl">
        </div>
        <div class="field mb-4 col-12">
          <label for="photo" class="font-medium text-900">Cambiar Foto de Perfil</label>
          <div style="display: flex; align-items: center;">
            <p-fileUpload #fileUpload mode="basic" name="avatar" accept="image/*" [maxFileSize]="1000000" styleClass="p-button-outlined p-button-plain" chooseLabel="Subir Imagen" (onSelect)="onSelect($event)"></p-fileUpload>
            <i class="pi pi-times" style="margin-left: 10px; cursor: pointer;" *ngIf="changeProfilePicture" (click)="onCancelSelect()"></i>
          </div>
        </div>
        <div class="field mb-4 col-12 md:col-6">
          <label for="email" class="font-medium text-900">Correo Electrónico</label>
          <input id="email" type="text" pInputText [(ngModel)]="email" [readonly]="true">
        </div>
        <div class="field mb-4 col-12 md:col-6">
          <label for="phone" class="font-medium text-900">Teléfono</label>
          <input id="phone" type="text" pInputText [formControl]="phoneControl">
        </div>

         <div class="field mb-4 col-12">
           <label for="bio" class="font-medium text-900">Acerca de mi</label>
           <textarea id="bio" type="text" pInputTextarea rows="5" [autoResize]="true" [formControl]="descriptionControl"></textarea>
         </div>
        <div class="col-12 lg:col-3 md:col-4 field">
          <button pButton pRipple label="Guardar" icon="pi pi-save" class="flex-auto" (click)="onSave()"></button>
        </div>
        <div class="col-12 lg:col-4 md:col-5 field">
          <button pButton pRipple label="Cambiar Contraseña" icon="pi pi-key" class="flex-auto p-button-outlined" (click)="visibleChangePassword = true"></button>
        </div>
       </div>
     </div>
   </div>
</div>

<ng-template #loading>
  <div class="col-12 lg:col-10" style="display: flex; justify-content: center; align-items: center; height: 100%;">
    <p-progressSpinner ariaLabel="Cargando..."></p-progressSpinner>
  </div>
</ng-template>

<p-dialog header="Cambiar Contraseña"  [(visible)]="visibleChangePassword" [modal]="true" [resizable]="false" showEffect="fade">
      <div class="mb-4">
        <span class="text-600 font-medium">Ingresa tu nueva contraseña</span>
      </div>
      <div class="flex flex-column">
          <span class="p-input-icon-left w-full mb-4">
                <i class="pi pi-lock z-2"></i>
                <p-password id="oldPassword" placeholder="Contraseña Actual" styleClass="w-full"  [inputStyle]="{paddingLeft: '2.5rem'}" inputStyleClass="w-full md:w-25rem" [toggleMask]="true" [formControl]="oldPasswordControl" [feedback]=false></p-password>
            </span>
            <span class="p-input-icon-left w-full mb-4">
                <i class="pi pi-lock z-2"></i>
                <p-password id="password" placeholder="Nueva Contraseña" styleClass="w-full"  [inputStyle]="{paddingLeft: '2.5rem'}" inputStyleClass="w-full md:w-25rem " [toggleMask]="true" [formControl]="passwordControl"></p-password>
            </span>
        <span class="p-input-icon-left w-full mb-4">
                <i class="pi pi-lock z-2"></i>
                <p-password id="confirmPassword" placeholder="Confirmar Nueva Contraseña" styleClass="w-full"  [inputStyle]="{paddingLeft: '2.5rem'}" inputStyleClass="w-full md:w-25rem" [toggleMask]="true" [feedback]="false" [formControl]="confirmPasswordControl"></p-password>
            </span>
        <div class="flex flex-wrap gap-2 justify-content-between">
          <button pButton pRipple label="Cancelar" class="flex-auto p-button-outlined" (click)="visibleChangePassword = false"></button>
          <button pButton pRipple label="Guardar" class="flex-auto" (click)="onSubmit()"></button>
        </div>
      </div>
</p-dialog>

